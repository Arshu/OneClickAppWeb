(function(a){a.widget("mobile.datebox",{initSelector:"input[data-role='datebox']",options:{version:"3-1.4.5-01",theme:false,themeDefault:"a",themeHeader:"a",themeSetButton:"a",mode:false,transition:"fade",useAnimation:true,hideInput:false,hideContainer:false,lockInput:true,zindex:"1100",clickEvent:"vclick",clickEventAlt:"click",defaultValue:false,showInitialValue:false,popupPosition:false,popupForceX:false,popupForceY:false,useModal:true,useModalTheme:"b",useInline:false,useInlineBlind:false,useHeader:true,useImmediate:false,useButton:true,buttonIcon:false,buttonIconDate:"calendar",buttonIconTime:"clock",useFocus:false,useClearButton:false,useCollapsedBut:false,usePlaceholder:false,beforeOpenCallback:false,beforeOpenCallbackArgs:[],openCallback:false,openCallbackArgs:[],closeCallback:false,closeCallbackArgs:[],startOffsetYears:false,startOffsetMonths:false,startOffsetDays:false,afterToday:false,beforeToday:false,notToday:false,maxDays:false,minDays:false,maxYear:false,minYear:false,blackDates:false,blackDatesRec:false,blackDays:false,whiteDates:true,minHour:false,maxHour:false,minuteStep:1,minuteStepRound:0,rolloverMode:{m:true,d:true,h:true,i:true,s:true},useLang:"default",lang:{"default":{setDateButtonLabel:"Set Date",setTimeButtonLabel:"Set Time",setDurationButtonLabel:"Set Duration",calTodayButtonLabel:"Jump to Today",calTomorrowButtonLabel:"Jump to Tomorrow",titleDateDialogLabel:"Set Date",titleTimeDialogLabel:"Set Time",daysOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysOfWeekShort:["Su","Mo","Tu","We","Th","Fr","Sa"],monthsOfYear:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsOfYearShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],durationLabel:["Days","Hours","Minutes","Seconds"],durationDays:["Day","Days"],timeFormat:24,headerFormat:"%A, %B %-d, %Y",tooltip:"Open Date Picker",nextMonth:"Next Month",prevMonth:"Previous Month",dateFieldOrder:["m","d","y"],timeFieldOrder:["h","i","a"],slideFieldOrder:["y","m","d"],dateFormat:"%Y-%m-%d",useArabicIndic:false,isRTL:false,calStartDay:0,clearButton:"Clear",durationOrder:["d","h","i","s"],meridiem:["AM","PM"],timeOutput:"%k:%M",durationFormat:"%Dd %DA, %Dl:%DM:%DS",calDateListLabel:"Other Dates",calHeaderFormat:"%B %Y"}}},_enhanceDate:function(){a.extend(this._date.prototype,{copy:function(c,b){c=a.extend([0,0,0,0,0,0,0],c);b=a.extend([0,0,0,0,0,0,0],b);return new Date(((b[0]>0)?b[0]:this.get(0)+c[0]),((b[1]>0)?b[1]:this.get(1)+c[1]),((b[2]>0)?b[2]:this.get(2)+c[2]),((b[3]>0)?b[3]:this.get(3)+c[3]),((b[4]>0)?b[4]:this.get(4)+c[4]),((b[5]>0)?b[5]:this.get(5)+c[5]),((b[6]>0)?b[5]:this.get(6)+c[6]))},adj:function(c,b){if(typeof b!=="number"||typeof c!=="number"){throw new Error("Invalid Arguments")}switch(c){case 0:this.setD(0,this.get(0)+b);break;case 1:this.setD(1,this.get(1)+b);break;case 2:this.setD(2,this.get(2)+b);break;case 3:b*=60;case 4:b*=60;case 5:b*=1000;case 6:this.setTime(this.getTime()+b);break}return this},setD:function(c,b){switch(c){case 0:this.setFullYear(b);break;case 1:this.setMonth(b);break;case 2:this.setDate(b);break;case 3:this.setHours(b);break;case 4:this.setMinutes(b);break;case 5:this.setSeconds(b);break;case 6:this.setMilliseconds(b);break}return this},get:function(b){switch(b){case 0:return this.getFullYear();case 1:return this.getMonth();case 2:return this.getDate();case 3:return this.getHours();case 4:return this.getMinutes();case 5:return this.getSeconds();case 6:return this.getMilliseconds()}return false},get12hr:function(){if(this.get(3)===0){return 12}if(this.get(3)<13){return this.get(3)}return this.get(3)-12},iso:function(){var b=[0,0,0],c=0;for(c=0;c<3;c++){b[c]=this.get(c);if(c===1){b[c]++}if(b[c]<10){b[c]="0"+String(b[c])}}return b.join("-")},comp:function(){return parseInt(this.iso().replace(/-/g,""),10)},getEpoch:function(){return Math.floor(this.getTime()/1000)},getArray:function(){var b=[0,0,0,0,0,0],c=0;for(c=0;c<6;c++){b[c]=this.get(c)}return b},setFirstDay:function(b){this.setD(2,1).adj(2,(b-this.getDay()));if(this.get(2)>10){this.adj(2,7)}return this},setDWeek:function(c,b){if(c===4){return this.setD(1,0).setD(2,1).setFirstDay(4).adj(2,-3).adj(2,(b-1)*7)}return this.setD(1,0).setD(2,1).setFirstDay(c).adj(2,(b-1)*7)},getDWeek:function(c){var d,b;switch(c){case 0:d=this.copy([0,-1*this.getMonth()]).setFirstDay(0);return Math.floor((this.getTime()-(d.getTime()+((this.getTimezoneOffset()-d.getTimezoneOffset())*60000)))/604800000)+1;case 1:d=this.copy([0,-1*this.getMonth()]).setFirstDay(1);return Math.floor((this.getTime()-(d.getTime()+((this.getTimezoneOffset()-d.getTimezoneOffset())*60000)))/604800000)+1;case 4:if(this.getMonth()===11&&this.getDate()>28){return 1}d=this.copy([0,-1*this.getMonth()],true).setFirstDay(4).adj(2,-3);b=Math.floor((this.getTime()-(d.getTime()+((this.getTimezoneOffset()-d.getTimezoneOffset())*60000)))/604800000)+1;if(b<1){d=this.copy([-1,-1*this.getMonth()]).setFirstDay(4).adj(2,-3);return Math.floor((this.getTime()-d.getTime())/604800000)+1}return b;default:return 0}}})},_event:function(f,d){var c,b=a(this).data("mobile-datebox");if(!f.isPropagationStopped()){switch(d.method){case"close":b.close();break;case"open":b.open();break;case"set":if(typeof d.value==="object"){b.theDate=d.value;b._t({method:"doset"})}else{a(this).val(d.value);a(this).trigger("change")}break;case"doset":c="_"+b.options.mode+"DoSet";if(a.isFunction(b[c])){b[c].apply(b,[])}else{b._t({method:"set",value:b._formatter(b.__fmt(),b.theDate),date:b.theDate})}break;case"dooffset":if(d.type){b._offset(d.type,d.amount,true)}break;case"dorefresh":b.refresh();break;case"doclear":a(this).val("").trigger("change");break;case"clear":a(this).trigger("change");break}}},_ord:{"default":function(c){var b=c%10;if((c>9&&c<21)||b>3){return"th"}return["th","st","nd","rd"][b]}},_dur:function(b){var c=[b/(60*60*1000*24),b/(60*60*1000)%24,b/(60*1000)%60,b/(1000)%60,];a.each(c,function(e,d){c[e]=parseInt(d,10)});return c},_gridblk:{g:[0,0,"a","b","c","d","e"],b:["a","b","c","d","e","f"]},__:function(f){var e=this.options,d=e.lang[e.useLang],c=e[e.mode+"lang"],b="override"+f.charAt(0).toUpperCase()+f.slice(1);if(typeof e[b]!=="undefined"){return e[b]}if(typeof d[f]!=="undefined"){return d[f]}if((typeof c!=="undefined")&&(typeof c[f]!=="undefined")){return c[f]}return e.lang["default"][f]},__fmt:function(){var b=this,c=this.options;if(typeof b.fmtOver!=="undefined"&&b.fmtOver!==false){return b.fmtOver}switch(c.mode){case"timebox":case"timeflipbox":return b.__("timeOutput");case"durationbox":case"durationflipbox":return b.__("durationFormat");default:return b.__("dateFormat")}},_zPad:function(b,c){if(typeof c!=="undefined"&&c==="-"){return String(b)}return(b<10?"0":"")+String(b)},_dRep:function(j,g){var e,d,h=48,b=57,c=1584,f="";if(g===-1){h+=c;b+=c;c=-1584}for(d=0;d<j.length;d++){e=j.charCodeAt(d);if(e>=h&&e<=b){f=f+String.fromCharCode(e+c)}else{f=f+String.fromCharCode(e)}}return f},_doIndic:function(){var b=this;b.d.intHTML.find("*").each(function(){if(a(this).children().length<1){a(this).text(b._dRep(a(this).text()))}else{if(a(this).hasClass("ui-datebox-slideday")){a(this).html(b._dRep(a(this).html()))}}});b.d.intHTML.find("input").each(function(){a(this).val(b._dRep(a(this).val()))})},_parser:{"default":function(){return false}},_n:function(c,b){return(c<0)?b:c},_pa:function(b,c){if(typeof c==="boolean"){return new this._date(b[0],b[1],b[2],0,0,0,0)}return new this._date(c.get(0),c.get(1),c.get(2),b[0],b[1],b[2],0)},_makeDate:function(n){var h,b,p,g,q=this,e=this.options,j=this.options.defaultValue,c=q.__fmt(),m=null,k=[],f=new q._date(),l={year:-1,mont:-1,date:-1,hour:-1,mins:-1,secs:-1,week:false,wtyp:4,wday:false,yday:false,meri:0};n=a.trim(((q.__("useArabicIndic")===true)?q._dRep(n,-1):n));if(typeof e.mode==="undefined"){return f}if(typeof q._parser[e.mode]!=="undefined"){return q._parser[e.mode].apply(q,[n])}if(e.mode==="durationbox"||e.mode==="durationflipbox"){c=c.replace(/%D([a-z])/gi,function(d,i){switch(i){case"d":case"l":case"M":case"S":return"("+d+"|[0-9]+)";
default:return".+?"}});c=new RegExp("^"+c+"$");m=c.exec(n);p=c.exec(q.__fmt());if(m===null||m.length!==p.length){if(typeof j==="number"&&j>0){return new q._date((q.initDate.getEpoch()+parseInt(j,10))*1000)}return new q._date(q.initDate.getTime())}b=q.initDate.getEpoch();for(h=1;h<m.length;h++){g=parseInt(m[h],10);if(p[h].match(/^%Dd$/i)){b=b+(g*86400)}if(p[h].match(/^%Dl$/i)){b=b+(g*3600)}if(p[h].match(/^%DM$/i)){b=b+(g*60)}if(p[h].match(/^%DS$/i)){b=b+(g)}}return new q._date(b*1000)}c=c.replace(/%(0|-)*([a-z])/gi,function(d,i,o){k.push(o);switch(o){case"p":case"P":case"b":case"B":return"("+d+"|.+?)";case"H":case"k":case"I":case"l":case"m":case"M":case"S":case"V":case"U":case"u":case"W":case"d":return"("+d+"|[0-9]{"+((i==="-")?"1,":"")+"2})";case"j":return"("+d+"|[0-9]{3})";case"s":return"("+d+"|[0-9]+)";case"g":case"y":return"("+d+"|[0-9]{2})";case"E":case"G":case"Y":return"("+d+"|[0-9]{1,4})";default:k.pop();return".+?"}});c=new RegExp("^"+c+"$");m=c.exec(n);p=c.exec(q.__fmt());if(m===null||m.length!==p.length){if(j!==false){switch(typeof j){case"object":if(a.isFunction(j.getDay)){f=j}else{if(j.length===3){f=q._pa(j,(e.mode.substr(0,4)==="time"?f:false))}}break;case"number":f=new q._date(j*1000);break;case"string":if(e.mode.substr(0,4)==="time"){b=a.extend([0,0,0],j.split(":")).slice(0,3);f=q._pa(b,f)}else{b=a.extend([0,0,0],j.split("-")).slice(0,3);b[1]--;f=q._pa(b,false)}break}}if(isNaN(f.getDate())){f=new q._date()}}else{for(h=1;h<m.length;h++){g=parseInt(m[h],10);switch(k[h-1]){case"s":return new q._date(parseInt(m[h],10)*1000);case"Y":case"G":l.year=g;break;case"E":l.year=g-543;break;case"y":case"g":if(e.afterToday||g<38){l.year=2000+g}else{l.year=1900+g}break;case"m":l.mont=g-1;break;case"d":l.date=g;break;case"H":case"k":case"I":case"l":l.hour=g;break;case"M":l.mins=g;break;case"S":l.secs=g;break;case"u":l.wday=g-1;break;case"w":l.wday=g;break;case"j":l.yday=g;break;case"V":l.week=g;l.wtyp=4;break;case"U":l.week=g;l.wtyp=0;break;case"W":l.week=g;l.wtyp=1;break;case"p":case"P":g=new RegExp("^"+m[h]+"$","i");l.meri=(g.test(q.__("meridiem")[0])?-1:1);break;case"b":b=a.inArray(m[h],q.__("monthsOfYearShort"));if(b>-1){l.mont=b}break;case"B":b=a.inArray(m[h],q.__("monthsOfYear"));if(b>-1){l.mont=b}break}}if(l.meri!==0){if(l.meri===-1&&l.hour===12){l.hour=0}if(l.meri===1&&l.hour!==12){l.hour=l.hour+12}}f=new q._date(q._n(l.year,0),q._n(l.mont,0),q._n(l.date,1),q._n(l.hour,0),q._n(l.mins,0),q._n(l.secs,0),0);if(l.year<100&&l.year!==-1){f.setFullYear(l.year)}if((l.mont>-1&&l.date>-1)||(l.hour>-1&&l.mins>-1&&l.secs>-1)){return f}if(l.week!==false){f.setDWeek(l.wtyp,l.week);if(l.date>-1){f.setDate(l.date)}}if(l.yday!==false){f.setD(1,0).setD(2,1).adj(2,(l.yday-1))}if(l.wday!==false){f.adj(2,(l.wday-f.getDay()))}}return f},_customformat:{"default":function(){return false}},_formatter:function(f,c){var b=this,g=this.options,d,e=0;if(g.mode.substr(0,4)==="dura"){e=b._dur(this.theDate.getTime()-this.initDate.getTime());if(!f.match(/%Dd/)){e[1]+=(e[0]*24)}if(!f.match(/%Dl/)){e[2]+=(e[1]*60)}if(!f.match(/%DM/)){e[3]+=(e[2]*60)}}f=f.replace(/%(D|X|0|-)*([1-9a-zA-Z])/g,function(h,i,j){if(i==="X"){if(typeof b._customformat[g.mode]!=="undefined"){return b._customformat[g.mode](j,c,g)}return h}if(i==="D"){switch(j){case"d":return e[0];case"l":return b._zPad(e[1]);case"M":return b._zPad(e[2]);case"S":return b._zPad(e[3]);case"A":return b.__("durationDays")[((e[0]===1)?0:1)];default:return h}}switch(j){case"a":return b.__("daysOfWeekShort")[c.getDay()];case"A":return b.__("daysOfWeek")[c.getDay()];case"b":return b.__("monthsOfYearShort")[c.getMonth()];case"B":return b.__("monthsOfYear")[c.getMonth()];case"C":return parseInt(c.getFullYear()/100);case"d":return b._zPad(c.getDate(),i);case"H":case"k":return b._zPad(c.getHours(),i);case"I":case"l":return b._zPad(c.get12hr(),i);case"m":return b._zPad(c.getMonth()+1,i);case"M":return b._zPad(c.getMinutes(),i);case"p":case"P":d=b.__("meridiem")[((c.get(3)<12)?0:1)].toUpperCase();return(j==="P"?d.toLowerCase():d);case"s":return c.getEpoch();case"S":return b._zPad(c.getSeconds(),i);case"u":return b._zPad(c.getDay()+1,i);case"w":return c.getDay();case"y":return b._zPad(c.getFullYear()%100);case"Y":return c.getFullYear();case"E":return c.getFullYear()+543;case"V":return b._zPad(c.getDWeek(4),i);case"U":return b._zPad(c.getDWeek(0),i);case"W":return b._zPad(c.getDWeek(1),i);case"o":if(typeof b._ord[g.useLang]!=="undefined"){return b._ord[g.useLang](c.getDate())}return b._ord["default"](c.getDate());case"j":d=new Date(c.getFullYear(),0,1);d="000"+String(Math.ceil((c-d)/86400000)+1);return d.slice(-3);case"G":d=c.getFullYear();if(c.getDWeek(4)===1&&c.getMonth()>0){return d+1}if(c.getDWeek(4)>51&&c.getMonth()<11){return d-1}return d;case"g":d=c.getFullYear%100;if(c.getDWeek(4)===1&&c.getMonth()>0){++d}if(c.getDWeek(4)>51&&c.getMonth()<11){--d}return b._zpad(d);default:return h}});if(b.__("useArabicIndic")===true){f=b._dRep(f)}return f},_btwn:function(d,b,c){return(d>b&&d<c)},_minStepFix:function(){var e=this.theDate.get(4),b=this.options.minuteStep,c=this.options.minStepRound,d=e%b;if(b>1&&d>0){if(c<0){e=e-d}else{if(c>0){e=e+(b-d)}else{if(e%b<b/2){e=e-d}else{e=e+(b-d)}}}this.theDate.setMinutes(e)}},_offset:function(g,e,h){var b=this,f=this.options,c=this.theDate,d=false;g=(g||"").toLowerCase();if(typeof h==="undefined"){h=true}if(g!=="a"&&(typeof f.rolloverMode[g]==="undefined"||f.rolloverMode[g]===true)){d=a.inArray(g,["y","m","d","h","i","s"])}else{switch(g){case"y":d=0;break;case"m":if(b._btwn(c.get(1)+e,-1,12)){d=1}break;case"d":if(b._btwn(c.get(2)+e,0,(32-c.copy([0],[0,0,32,13]).get(3)+1))){d=2}break;case"h":if(b._btwn(c.get(3)+e,-1,24)){d=3}break;case"i":if(b._btwn(c.get(4)+e,-1,60)){d=4}break;case"s":if(b._btwn(c.get(5)+e,-1,60)){d=5}break;case"a":b._offset("h",((e>0)?1:-1)*12,false);break}}if(d!==false){b.theDate.adj(d,e)}if(h===true){b.refresh()}if(f.useImmediate){b._t({method:"doset"})}b._t({method:"offset",type:g,amount:e,newDate:b.theDate})},_startOffset:function(b){var c=this.options;if(c.startOffsetYears!==false){b.adj(0,c.startOffsetYears)}if(c.startOffsetMonths!==false){b.adj(1,c.startOffsetMonths)}if(c.startOffsetDays!==false){b.adj(2,c.startOffsetDays)}return b},_destroy:function(){var b=this,d=this.options,c=this.d.wrap.find("a");b.d.wrap.removeClass("ui-input-has-clear");c.remove();if(d.lockInput){b.d.input.removeAttr("readonly")}b.d.input.off("datebox").off("focus.datebox").off("blur.datebox").off("change.datebox");a(document).off(b.drag.eMove).off(b.drag.eEnd).off(b.drag.eEndA)},_create:function(){a(document).trigger("dateboxcreate");var b=this,i=a.extend(this.options,this._getLongOptions(this.element),this.element.data("options")),c=((i.theme===false)?a.mobile.getInheritedTheme(this.element):i.theme),e=i.useAnimation?i.transition:"none",h={input:this.element,wrap:this.element.parent(),mainWrap:a("<div>",{"class":"ui-datebox-container ui-overlay-shadow ui-corner-all ui-datebox-hidden "+e+" ui-body-"+c}).css("zIndex",i.zindex),intHTML:false},g=".datebox"+this.uuid,j=(typeof window.ontouchstart!=="undefined"),f={eStart:(j?"touchstart":"mousedown")+g,eMove:(j?"touchmove":"mousemove")+g,eEnd:(j?"touchend":"mouseup")+g,eEndA:(j?(["mouseup","touchend","touchcanel","touchmove"].join(g+" ")+g):"mouseup"+g),move:false,start:false,end:false,pos:false,target:false,delta:false,tmp:false};a.extend(b,{d:h,drag:f,touch:j});if(i.usePlaceholder!==false){if(i.usePlaceholder===true&&b._grabLabel()!==""){b.d.input.attr("placeholder",b._grabLabel())}if(typeof i.usePlaceholder==="string"){b.d.input.attr("placeholder",i.usePlaceholder)}}i.theme=c;b.disabled=false;b.runButton=false;b._date=window.Date;b._enhanceDate();b.baseID=b.d.input.attr("id");b.initDate=new b._date();b.initDate.setMilliseconds(0);b.theDate=(i.defaultValue)?b._makeDate():((b.d.input.val()!=="")?b._makeDate(b.d.input.val()):new b._date());if(b.d.input.val()===""){b._startOffset(b.theDate)}b.initDone=false;if(i.showInitialValue){b.d.input.val(b._formatter(b.__fmt(),b.theDate))
}if(i.useButton){if(i.mode!==false){b.d.wrap.addClass("ui-input-has-clear");if(i.buttonIcon===false){if(i.mode.substr(0,4)==="time"||i.mode.substr(0,3)==="dur"){i.buttonIcon=i.buttonIconTime}else{i.buttonIcon=i.buttonIconDate}}a("<a href='#' class='ui-input-clear ui-btn ui-icon-"+i.buttonIcon+" ui-btn-icon-notext ui-corner-all'></a>").attr("title",b.__("tooltip")).text(b.__("tooltip")).appendTo(b.d.wrap).on(i.clickEvent,function(d){d.preventDefault();if(i.useFocus){b.d.input.focus()}else{if(!b.disabled){b._t({method:"open"})}}})}}if(i.hideInput){b.d.wrap.hide()}if(i.hideContainer){b.d.wrap.parent().hide()}b.d.input.on("focus.datebox",function(){b.d.input.addClass("ui-focus");if(b.disabled===false&&i.useFocus){b._t({method:"open"})}}).on("blur.datebox",function(){b.d.input.removeClass("ui-focus")}).on("change.datebox",function(){b.theDate=b._makeDate(b.d.input.val());b.refresh()}).on("datebox",b._event);if(i.lockInput){b.d.input.attr("readonly","readonly")}if(typeof a.event.special.mousewheel!=="undefined"){b.wheelExists=true}if(b.d.input.is(":disabled")){b.disable()}b.applyMinMax(false,false);if(i.useInline||i.useInlineBlind){b.open()}a(document).trigger("dateboxaftercreate")},applyMinMax:function(g,b){var j,e,i,d,k=this,c=this.options,h=new this._date(),f=24*60*60*1000;j=k._pa([0,0,0],h);if(typeof g==="undefined"){g=true}if(typeof b==="undefined"){b=true}if((b===true||c.minDays===false)&&(typeof k.d.input.attr("min")!=="undefined")){e=k.d.input.attr("min").split("-");i=new k._date(e[0],e[1]-1,e[2],0,0,0,0);d=(i.getTime()-j.getTime())/f;c.minDays=parseInt(d*-1,10)+0}if((b===true||c.maxDays===false)&&(typeof k.d.input.attr("max")!=="undefined")){e=k.d.input.attr("max").split("-");i=new k._date(e[0],e[1]-1,e[2],0,0,0,0);d=(i.getTime()-j.getTime())/f;c.maxDays=parseInt(d,10)-1}if(g===true){k._t({method:"refresh"})}},_build:{"default":function(){this.d.headerText="Error";if(this.d.intHTML!==false){this.d.intHTML.remove().empty()}this.d.intHTML=a("<div class='ui-body-b'><h2 style='text-align:center'>Unknown Mode</h2></div>")}},_drag:{"default":function(){return false}},open:function(){var b=this,e=this.options,c={transition:(e.useAnimation?e.transition:"none")},d={history:false,transition:(e.useAnimation?e.transition:"none")};if(e.useFocus&&b.fastReopen===true){b.d.input.blur();return false}b.theDate=b._makeDate(b.d.input.val());if(b.d.input.val()===""){b._startOffset(b.theDate)}b.d.input.blur();if(typeof b._build[e.mode]==="undefined"){b._build["default"].apply(b,[])}else{b._build[e.mode].apply(b,[])}if(typeof b._drag[e.mode]!=="undefined"){b._drag[e.mode].apply(b,[])}b._t({method:"refresh"});if(b.__("useArabicIndic")===true){b._doIndic()}if((e.useInline||e.useInlineBlind)&&b.initDone===false){b.d.mainWrap.append(b.d.intHTML);if(e.hideContainer){if(e.useHeader){b.d.mainWrap.prepend(a("<div class='ui-header ui-bar-"+e.themeHeader+"'><h1 class='ui-title'>"+b.d.headerText+"</h1></div>"))}b.d.wrap.parent().after(b.d.mainWrap)}else{b.d.wrap.parent().append(b.d.mainWrap)}b.d.mainWrap.removeClass("ui-datebox-hidden ui-overlay-shadow");if(e.useInline){b.d.mainWrap.addClass("ui-datebox-inline");if(!e.hideInput&&!e.hideContainer){b.d.mainWrap.addClass("ui-datebox-inline-has-input")}setTimeout((function(f){return function(){f._t({method:"postrefresh"})}}(b)),100);return true}else{b.d.mainWrap.addClass("ui-datebox-inline ui-datebox-inline-has-input");b.d.mainWrap.hide()}b.initDone=false;b._t({method:"postrefresh"})}if(e.useInlineBlind){if(b.initDone){b.refresh();b.d.mainWrap.slideDown();b._t({method:"postrefresh"})}else{b.initDone=true}return true}if(b.d.intHTML.is(":visible")){return false}b.d.mainWrap.empty();if(e.useHeader){b.d.mainWrap.append(a("<a href='#'>Close</a>").addClass("ui-btn-left ui-link ui-btn ui-btn-a ui-icon-delete ui-btn-icon-notext ui-shadow ui-corner-all").on(e.clickEventAlt,function(f){f.preventDefault();b._t({method:"close"})}));b.d.mainWrap.append(a("<div class='ui-header ui-bar-"+e.themeHeader+"'><h1 class='ui-title'>"+b.d.headerText+"</h1></div>"))}b.d.mainWrap.append(b.d.intHTML).css("zIndex",e.zindex);b._t({method:"postrefresh"});if(e.popupPosition!==false){c.positionTo=e.popupPosition}else{if(typeof b.baseID!=="undefined"){c.positionTo="#"+b.baseID}else{c.positionTo="window"}}if(e.popupForceX!==false&&e.popupForceY!==false){c.x=parseInt(e.popupForceX,10);c.y=parseInt(e.popupForceY,10);c.positionTo="origin"}if(e.useModal){d.overlayTheme=e.useModalTheme;d.dismissible=false}if(e.openCallback!==false){if(!a.isFunction(e.openCallback)){if(typeof window[e.openCallback]==="function"){e.openCallback=window[e.openCallback]}}d.afteropen=function(){b._t({method:"postrefresh"});if(e.openCallback.apply(b,a.merge([{custom:b.customCurrent,initDate:b.initDate,date:b.theDate,duration:b.lastDuration}],e.openCallbackArgs))===false){b._t({method:"close"})}}}else{d.afteropen=function(){b._t({method:"postrefresh"})}}if(e.closeCallback!==false){if(!a.isFunction(e.closeCallback)){if(typeof window[e.closeCallback]==="function"){e.closeCallback=window[e.closeCallback]}}d.afterclose=function(){e.closeCallback.apply(b,a.merge([{custom:b.customCurrent,initDate:b.initDate,date:b.theDate,duration:b.lastDuration}],e.closeCallbackArgs))}}if(e.beforeOpenCallback!==false){if(!a.isFunction(e.beforeOpenCallback)){if(typeof window[e.beforeOpenCallback]==="function"){e.beforeOpenCallback=window[e.beforeOpenCallback]}}if(e.beforeOpenCallback.apply(b,a.merge([{custom:b.customCurrent,initDate:b.initDate,date:b.theDate,duration:b.lastDuration}],e.beforeOpenCallbackArgs))===false){return false}}b.d.mainWrap.removeClass("ui-datebox-hidden").popup(d).popup("open",c)},close:function(){var b=this,c=this.options;if(c.useInlineBlind){b.d.mainWrap.slideUp();return true}if(c.useInline||b.d.intHTML===false){return true}b.d.mainWrap.popup("close");a(document).off(b.drag.eMove).off(b.drag.eEnd).off(b.drag.eEndA);if(c.useFocus){b.fastReopen=true;setTimeout((function(d){return function(){d.fastReopen=false}}(b)),300)}},refresh:function(){var b=this,c=this.options;if(typeof b._build[c.mode]==="undefined"){b._build["default"].apply(b,[])}else{b._build[c.mode].apply(b,[])}if(b.__("useArabicIndic")===true){b._doIndic()}b.d.mainWrap.append(b.d.intHTML);b._t({method:"postrefresh"})},_check:function(){var j,f,g,d,e,b=this,h=this.options,c=this.theDate;b.dateOK=true;if(typeof h.mode==="undefined"){return true}if(h.afterToday){j=new b._date();if(c<j){c=j}}if(h.beforeToday){j=new b._date();if(c>j){c=j}}if(h.maxDays!==false){j=new b._date();j.adj(2,h.maxDays);if(c>j){c=j}}if(h.minDays!==false){j=new b._date();j.adj(2,-1*h.minDays);if(c<j){c=j}}if(h.minHour!==false){if(c.get(3)<h.minHour){c.setD(3,h.minHour)}}if(h.maxHour!==false){if(c.get(3)>h.maxHour){c.setD(3,h.maxHour)}}if(h.maxYear!==false){j=new b._date(h.maxYear,11,31);if(c>j){c=j}}if(h.minYear!==false){j=new b._date(h.minYear,0,1);if(c<j){c=j}}if(h.mode.substr(0,4)==="time"||h.mode.substr(0,3)==="dur"){if(h.mode==="timeflipbox"&&h.validHours!==false){if(a.inArray(c.get(3),h.validHours)<0){b.dateOK=false}}}else{if(h.blackDatesRec!==false){f=c.get(0);g=c.get(1);d=c.get(2);for(e=0;e<h.blackDatesRec.length;e++){if((h.blackDatesRec[e][0]===-1||h.blackDatesRec[e][0]===f)&&(h.blackDatesRec[e][1]===-1||h.blackDatesRec[e][1]===g)&&(h.blackDatesRec[e][2]===-1||h.blackDatesRec[e][2]===d)){b.dateOK=false}}}if(h.blackDates!==false){if(a.inArray(c.iso(),h.blackDates)>-1){b.dateOK=false}}if(h.blackDays!==false){if(a.inArray(c.getDay(),h.blackDays)>-1){b.dateOK=false}}if(h.whiteDates!==false){if(a.inArray(c.iso(),h.whiteDates)>-1){b.dateOK=true}}}b.theDate=c},_grabLabel:function(){var d,c,b=this,f=this.options,e=false;if(typeof f.overrideDialogLabel==="undefined"){d=b.d.input.attr("placeholder");c=b.d.input.attr("title");if(typeof d!=="undefined"){return d}if(typeof c!=="undefined"){return c}e=a(document).find("label[for='"+b.d.input.attr("id")+"']").text();return(e==="")?false:e}return f.overrideDialogLabel},_stdBtn:{clear:function(){var b=this,c=this.options;return a("<a href='#' role='button'>"+b.__("clearButton")+"</a>").addClass("ui-btn ui-btn-"+c.theme+" ui-icon-delete ui-btn-icon-left ui-shadow ui-corner-all").on(c.clickEventAlt,function(d){d.preventDefault();
b.d.input.val("");b._t({method:"clear"});b._t({method:"close"})})},close:function(b){var c=this,d=this.options;return a("<a href='#' role='button'>"+b+"</a>").addClass("ui-btn ui-btn-"+d.themeSetButton+" ui-icon-check ui-btn-icon-left ui-shadow ui-corner-all"+((c.dateOK===true)?"":" ui-state-disabled")).on(d.clickEventAlt,function(f){f.preventDefault();if(c.dateOK===true){c._t({method:"set",value:c._formatter(c.__fmt(),c.theDate),date:c.theDate});c._t({method:"close"})}})}},_makeEl:function(d,e){var b=false,c=false;c=d.clone();if(typeof e.attr!=="undefined"){for(b in e.attr){if(e.attr.hasOwnProperty(b)){c.data(b,e.attr[b])}}}return c},_getLongOptions:function(f){var e,b,d={},g="datebox",c=7;for(e in f.data()){if(e.substr(0,c)===g&&e.length>c){b=e.substr(c);b=b.charAt(0).toLowerCase()+b.slice(1);if(b!=="options"){d[b]=f.data(e)}}}return d},disable:function(){var b=this;b.d.input.attr("disabled",true);b.d.wrap.addClass("ui-state-disabled").blur();b.disabled=true;b.d.mainWrap.addClass("ui-state-disabled");b._t({method:"disable"})},enable:function(){var b=this;b.d.input.attr("disabled",false);b.d.wrap.removeClass("ui-state-disabled");b.disabled=false;b.d.mainWrap.removeClass("ui-state-disabled");b._t({method:"enable"})},_setOption:function(){a.Widget.prototype._setOption.apply(this,arguments);this.refresh()},getTheDate:function(){return this.theDate},getLastDur:function(){return this.lastDuration},setTheDate:function(b){if(typeof(b)==="object"){this.theDate=b}else{this.theDate=this._makeDate(b)}this.refresh();this._t({method:"doset"})},parseDate:function(e,d){var c,b=this;b.fmtOver=e;c=b._makeDate(d);b.fmtOver=false;return c},callFormat:function(c,b){return this._formatter(c,b)},getOption:function(c){var b=this.__(c);if(typeof b!=="undefined"){return b}else{return this.options[c]}},_t:function(b){this.d.input.trigger("datebox",b)}})})(jQuery);