var nextRequestId=0;var jsonSecureHandler="/Handler/JsonSecure.ashx";var jsonAuthSecureHandler="/Handler/JsonAuthSecure.ashx";function loadSelectOption(e,f,b,d,i,c){var a=true;if(a==true){var h="{";h+='"pageNo" : 1';h+=', "itemsPerPage" : 100';h+="}";var g={id:++nextRequestId,method:f,params:h};asyncJsonRequest(e,g,d,function(m){var p=false;if(m.hasOwnProperty("Result")===true){var n=m.Result;if(n.hasOwnProperty("error")===true){var l=n.error;showError(l,d)}else{if(n.hasOwnProperty("html")===true){var j=document.getElementById(b);if(j){var k="#"+b;$(k).html(n.html);j.selectedIndex=i;$(k).selectmenu("refresh");if(typeof(c)==="function"){c()}}}else{if(n.hasOwnProperty("data")===true){var j=document.getElementById(b);if(j){var q=n.data;j.options.length=0;for(var o=0;o<q.length;o++){var s=q[o].Key;var r=q[o].Value;if(r.hasOwnProperty("OptionName")){var t=r.OptionName;j.options[j.options.length]=new Option(t,s)}}if(i==999){j.selectedIndex=j.options.length-1}else{j.selectedIndex=i}var k="#"+b;$(k).selectmenu("refresh");if(typeof(c)==="function"){c()}}}}}}})}}function loadULHtml(e,f,h,d,b,c){var a=true;if(a==true){var i="{";i+='"pageNo" : '+b;i+=', "itemsPerPage" : '+c;i+="}";var g={id:++nextRequestId,method:f,params:i};asyncJsonRequest(e,g,d,function(l){var o=false;if(l.hasOwnProperty("Result")===true){var k=l.Result;if(k.hasOwnProperty("error")===true){var n=k.error;showError(n,d)}else{if(k.hasOwnProperty("html")===true){var j=document.getElementById(h);if(j){var m="#"+h;$(m).html(k.html);$(m).listview("refresh")}}}}})}}function fillRolesSelectTag(b,c,a){loadSelectOption(jsonAuthSecureHandler,"GetRoleOptionList",b,c,a)}function fillRoleUsersUvTag(c,b,a,d){loadULHtml(jsonAuthSecureHandler,"GetRoleUserListHtml",c,b,a,d)}function isAuthenticated(d,a){var c=true;if(c==true){var e="{";e+="}";var b={id:++nextRequestId,method:"IsAuthenticated",params:e};asyncJsonRequest(jsonSecureHandler,b,a,function(g){var j=false;if(g.hasOwnProperty("Result")===true){var f=g.Result;if(f.hasOwnProperty("message")===true){window.location.replace(d);if(a.length>0){var i=f.message;showSuccess(i,a)}}else{if(f.hasOwnProperty("error")===true){var h=f.error;showError(h,a)}}}})}}function fillUserId(e,a){var c=true;if(c==true){var d="{";d+="}";var b={id:++nextRequestId,method:"GetLoginUser",params:d};asyncJsonRequest(jsonAuthSecureHandler,b,a,function(g){var j=false;if(g.hasOwnProperty("Result")===true){var f=g.Result;if(f.hasOwnProperty("data")===true){var l=document.getElementById(e);if(l){var k=f.data;l.value=k}}if(f.hasOwnProperty("message")===true){if(a.length>0){var i=f.message;showSuccess(i,a)}}else{if(f.hasOwnProperty("error")===true){var h=f.error;showError(h,a)}}}})}}function logOffUser(a){var c=true;if(c==true){var d="{";d+="}";var b={id:++nextRequestId,method:"LogOffUser",params:d};asyncJsonRequest(jsonSecureHandler,b,a,function(f){var i=false;if(f.hasOwnProperty("Result")===true){var e=f.Result;if(e.hasOwnProperty("message")===true){window.location.replace("/Index.ashx");var h=e.message;showSuccess(h,a)}else{if(e.hasOwnProperty("error")===true){var g=e.error;showError(g,a)}}}})}}function loginUser(f,c,h,a,b){var e=true;if(e==true){var g="{";g+='"userName" : "'+encodeURIComponent(f)+'"';g+=', "userPassword" : "'+encodeURIComponent(c)+'"';g+=', "rememberMe" : '+h;g+="}";var d={id:++nextRequestId,method:"LoginUser",params:g};asyncJsonRequest(jsonSecureHandler,d,a,function(k){var n=false;if(k.hasOwnProperty("Result")===true){var j=k.Result;if(j.hasOwnProperty("message")===true){window.location.replace("/Index.ashx");var m=j.message;showSuccess(m,a)}else{if(j.hasOwnProperty("error")===true){var l=j.error;showError(l,a)}}if(j.hasOwnProperty("warn")===true){var i=j.warn;showWarning(i,b)}}})}}function changePassword(b,f,g,a){var d=true;if(d==true){var e="{";e+=', "userId" : "'+encodeURIComponent(b)+'"';e+=', "oldPassword" : "'+encodeURIComponent(f)+'"';e+=', "newPassword" : "'+encodeURIComponent(g)+'"';e+="}";var c={id:++nextRequestId,method:"ChangePassword",params:e};asyncJsonRequest(jsonAuthSecureHandler,c,a,function(i){var l=false;if(i.hasOwnProperty("Result")===true){var h=i.Result;if(h.hasOwnProperty("message")===true){var k=h.message;showSuccess(k,a)}else{if(h.hasOwnProperty("error")===true){var j=h.error;showError(j,a)}}}})}}function registerUser(b,d,c,a){var f=true;if(f==true){var g="{";g+=', "userId" : "'+encodeURIComponent(b)+'"';g+=', "userEmail" : "'+encodeURIComponent(d)+'"';g+=', "userPassword" : "'+encodeURIComponent(c)+'"';g+="}";var e={id:++nextRequestId,method:"RegisterUser",params:g};asyncJsonRequest(jsonAuthSecureHandler,e,a,function(i){var l=false;if(i.hasOwnProperty("Result")===true){var h=i.Result;if(h.hasOwnProperty("message")===true){var k=h.message;showSuccess(k,a)}else{if(h.hasOwnProperty("error")===true){var j=h.error;showError(j,a)}}}})}}function addUserToRole(c,b,a){var e=true;if(e==true){var f="{";f+=', "userId" : "'+encodeURIComponent(c)+'"';f+=', "roleName" : "'+encodeURIComponent(b)+'"';f+="}";var d={id:++nextRequestId,method:"AddUserToRole",params:f};asyncJsonRequest(jsonAuthSecureHandler,d,a,function(h){var k=false;if(h.hasOwnProperty("Result")===true){var g=h.Result;if(g.hasOwnProperty("message")===true){var j=g.message;showSuccess(j,a);if(typeof(refreshRoleUsersUvTag)==="function"){refreshRoleUsersUvTag()}}else{if(g.hasOwnProperty("error")===true){var i=g.error;showError(i,a)}}}})}}function removeUserFromRole(c,b,a){var e=true;if(e==true){var f="{";f+=', "userId" : "'+encodeURIComponent(c)+'"';f+=', "roleName" : "'+encodeURIComponent(b)+'"';f+="}";var d={id:++nextRequestId,method:"RemoveUserFromRole",params:f};asyncJsonRequest(jsonAuthSecureHandler,d,a,function(h){var k=false;if(h.hasOwnProperty("Result")===true){var g=h.Result;if(g.hasOwnProperty("message")===true){var j=g.message;showSuccess(j,a);if(typeof(refreshRoleUsersUvTag)==="function"){refreshRoleUsersUvTag()}}else{if(g.hasOwnProperty("error")===true){var i=g.error;showError(i,a)}}}})}}function btnLogOffUser(a){var b=document.getElementById(a);if(b){b.innerHTML="";b.className="";logOffUser(a)}}function btnLoginUser(a,g,c,b){var e=document.getElementById(b);var f=document.getElementById(a);var h=document.getElementById(g);var d=document.getElementById(c);if((f)&&(h)&&(d)&&(e)){e.innerHTML="";e.className="";if(f.value.length==0){e.className="error";e.innerHTML="Please enter User Name";$(e).show()}else{if(h.value.length==0){e.className="error";e.innerHTML="Please enter User Password";$(e).show()}else{if(d.checked==true){loginUser(f.value,h.value,true,b)}else{loginUser(f.value,h.value,false,b)}}}}}function btnChangePassword(j,f,i,e,c){var d=document.getElementById(c);d.innerHTML="";d.className="";var a=document.getElementById(j);var h=document.getElementById(f);var g=document.getElementById(i);var b=document.getElementById(e);if((a)&&(h)&&(g)&&(b)&&(d)){if(a.value.length==0){d.className="error";d.innerHTML="Please enter User Id";$(d).show()}else{if(h.value.length==0){d.className="error";d.innerHTML="Please enter Old Password";$(d).show()}else{if(g.value.length==0){d.className="error";d.innerHTML="Please enter New Password";$(d).show()}else{if(b.value.length==0){d.className="error";d.innerHTML="Please enter New Confirm Password";$(d).show()}else{if(g.value!=b.value){d.className="error";d.innerHTML="Please Enter the Password and Confirm Password as the Same";$(d).show()}else{changePassword(a.value,h.value,g.value,c)}}}}}}}function btnRegisterUser(j,i,h,g,c){var d=document.getElementById(c);d.innerHTML="";d.className="";var b=document.getElementById(j);var a=document.getElementById(i);var f=document.getElementById(h);var e=document.getElementById(g);if((b)&&(a)&&(f)&&(e)&&(d)){if(b.value.length==0){d.className="error";d.innerHTML="Please enter User Id";$(d).show()}else{if(a.value.length==0){d.className="error";d.innerHTML="Please enter User Email";$(d).show()}else{if(f.value.length==0){d.className="error";d.innerHTML="Please enter User Password";$(d).show()}else{if(e.value.length==0){d.className="error";
d.innerHTML="Please enter User Confirm Password";$(d).show()}else{if(f.value!=e.value){d.className="error";d.innerHTML="Please Enter the Password and Confirm Password as the Same";$(d).show()}else{registerUser(b.value,a.value,f.value,c)}}}}}}}function btnAddRemoveUserRole(e,a,f,c){var d=document.getElementById(c);d.innerHTML="";d.className="";var g=document.getElementById(a);var b=document.getElementById(f);if((g)&&(b)&&(d)){if(g.value.length==0){d.className="error";d.innerHTML="Please enter User Id";$(d).show()}else{if(b.value.length==0){d.className="error";d.innerHTML="Please select User Role";$(d).show()}else{if(e===true){addUserToRole(g.value,b.value,c)}else{removeUserFromRole(g.value,b.value,c)}}}}};