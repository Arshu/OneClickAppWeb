var nextRequestId=0;var jsonSecureHandler="/Handler/JsonSecure.ashx";var jsonAuthSecureHandler="/Handler/JsonAuthSecure.ashx";function fillRolesSelectTag(b,c,a){loadSelectOption(jsonAuthSecureHandler,"GetRoleOptionList",b,c,a)}function fillRoleUsersUvTag(c,b,a,d){loadULHtml(jsonAuthSecureHandler,"GetRoleUserListHtml",c,b,a,d)}function logOffUser(a){var c=true;if(c==true){var d="{";d+="}";var b={id:++nextRequestId,method:"LogOffUser",params:d};asyncJsonRequest(jsonSecureHandler,b,a,function(f){var i=false;if(f.hasOwnProperty("Result")===true){var e=f.Result;if(e.hasOwnProperty("message")===true){window.location.replace("/Index.ashx");var h=e.message;showSuccess(h,a)}else{if(e.hasOwnProperty("error")===true){var g=e.error;showError(g,a)}}}})}}function loginUser(e,b,g,a){var d=true;if(d==true){var f="{";f+='"userName" : "'+encodeURIComponent(e)+'"';f+=', "userPassword" : "'+encodeURIComponent(b)+'"';f+=', "rememberMe" : '+g;f+="}";var c={id:++nextRequestId,method:"LoginUser",params:f};asyncJsonRequest(jsonSecureHandler,c,a,function(i){var l=false;if(i.hasOwnProperty("Result")===true){var h=i.Result;if(h.hasOwnProperty("message")===true){window.location.replace("/Index.ashx");var k=h.message;showSuccess(k,a)}else{if(h.hasOwnProperty("error")===true){var j=h.error;showError(j,a)}}}})}}function registerUser(b,d,c,a){var f=true;if(f==true){var g="{";g+=', "userId" : "'+encodeURIComponent(b)+'"';g+=', "userEmail" : "'+encodeURIComponent(d)+'"';g+=', "userPassword" : "'+encodeURIComponent(c)+'"';g+="}";var e={id:++nextRequestId,method:"RegisterUser",params:g};asyncJsonRequest(jsonAuthSecureHandler,e,a,function(i){var l=false;if(i.hasOwnProperty("Result")===true){var h=i.Result;if(h.hasOwnProperty("message")===true){var k=h.message;showSuccess(k,a)}else{if(h.hasOwnProperty("error")===true){var j=h.error;showError(j,a)}}}})}}function addUserToRole(c,b,a){var e=true;if(e==true){var f="{";f+=', "userId" : "'+encodeURIComponent(c)+'"';f+=', "roleName" : "'+encodeURIComponent(b)+'"';f+="}";var d={id:++nextRequestId,method:"AddUserToRole",params:f};asyncJsonRequest(jsonAuthSecureHandler,d,a,function(h){var k=false;if(h.hasOwnProperty("Result")===true){var g=h.Result;if(g.hasOwnProperty("message")===true){var j=g.message;showSuccess(j,a);if(typeof(refreshRoleUsersUvTag)==="function"){refreshRoleUsersUvTag()}}else{if(g.hasOwnProperty("error")===true){var i=g.error;showError(i,a)}}}})}}function removeUserFromRole(c,b,a){var e=true;if(e==true){var f="{";f+=', "userId" : "'+encodeURIComponent(c)+'"';f+=', "roleName" : "'+encodeURIComponent(b)+'"';f+="}";var d={id:++nextRequestId,method:"RemoveUserFromRole",params:f};asyncJsonRequest(jsonAuthSecureHandler,d,a,function(h){var k=false;if(h.hasOwnProperty("Result")===true){var g=h.Result;if(g.hasOwnProperty("message")===true){var j=g.message;showSuccess(j,a);if(typeof(refreshRoleUsersUvTag)==="function"){refreshRoleUsersUvTag()}}else{if(g.hasOwnProperty("error")===true){var i=g.error;showError(i,a)}}}})}}function btnLogOffUser(a){var b=document.getElementById(a);if(b){b.innerHTML="";b.className="";logOffUser(a)}}function btnLoginUser(a,g,c,b){var e=document.getElementById(b);var f=document.getElementById(a);var h=document.getElementById(g);var d=document.getElementById(c);if((f)&&(h)&&(d)&&(e)){e.innerHTML="";e.className="";if(f.value.length==0){e.className="error";e.innerHTML="Please enter User Name";$(e).show()}else{if(h.value.length==0){e.className="error";e.innerHTML="Please enter User Password";$(e).show()}else{if(d.checked==true){loginUser(f.value,h.value,true,b)}else{loginUser(f.value,h.value,false,b)}}}}}function btnRegisterUser(j,i,h,g,c){var d=document.getElementById(c);d.innerHTML="";d.className="";var b=document.getElementById(j);var a=document.getElementById(i);var f=document.getElementById(h);var e=document.getElementById(g);if((b)&&(a)&&(f)&&(e)&&(d)){if(b.value.length==0){d.className="error";d.innerHTML="Please enter User Id";$(d).show()}else{if(a.value.length==0){d.className="error";d.innerHTML="Please enter User Email";$(d).show()}else{if(f.value.length==0){d.className="error";d.innerHTML="Please enter User Password";$(d).show()}else{if(e.value.length==0){d.className="error";d.innerHTML="Please enter User Confirm Password";$(d).show()}else{if(f.value!=e.value){d.className="error";d.innerHTML="Please Enter the Password and Confirm Password as the Same";$(d).show()}else{registerUser(b.value,a.value,f.value,c)}}}}}}}function btnAddRemoveUserRole(e,a,f,c){var d=document.getElementById(c);d.innerHTML="";d.className="";var g=document.getElementById(a);var b=document.getElementById(f);if((g)&&(b)&&(d)){if(g.value.length==0){d.className="error";d.innerHTML="Please enter User Id";$(d).show()}else{if(b.value.length==0){d.className="error";d.innerHTML="Please select User Role";$(d).show()}else{if(e===true){addUserToRole(g.value,b.value,c)}else{removeUserFromRole(g.value,b.value,c)}}}}};